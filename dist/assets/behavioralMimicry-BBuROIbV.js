var h=Object.defineProperty;var g=(i,e,t)=>e in i?h(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var m=(i,e,t)=>g(i,typeof e!="symbol"?e+"":e,t);class u{constructor(){m(this,"mimicryPatterns",[{id:"google_drive_file",serviceName:"Google Drive",template:"/file/d/{fileid}/view?usp=sharing&resourcekey={resourcekey}&export=download&confirm={confirm}",category:"cloud_storage",trustScore:98,recognitionRate:95,description:"Google Drive file sharing link",placeholders:["fileid","resourcekey","confirm"],headers:{"Content-Type":"application/pdf","Content-Disposition":"attachment"},queryParams:{usp:"sharing",export:"download"}},{id:"google_drive_folder",serviceName:"Google Drive",template:"/drive/folders/{folderid}?usp=sharing&resourcekey={resourcekey}&hl=en",category:"cloud_storage",trustScore:96,recognitionRate:93,description:"Google Drive folder sharing",placeholders:["folderid","resourcekey"],headers:{"Content-Type":"text/html"},queryParams:{usp:"sharing",hl:"en"}},{id:"dropbox_file",serviceName:"Dropbox",template:"/s/{shareid}/{filename}?dl=1&token_hash={tokenhash}&expires={expires}",category:"cloud_storage",trustScore:95,recognitionRate:92,description:"Dropbox file sharing link",placeholders:["shareid","filename","tokenhash","expires"],headers:{"Content-Type":"application/octet-stream","Content-Disposition":'attachment; filename="{filename}"'},queryParams:{dl:"1"}},{id:"dropbox_folder",serviceName:"Dropbox",template:"/sh/{folderid}/{foldername}?dl=0&preview={filename}&subfolder_nav_tracking=1",category:"cloud_storage",trustScore:93,recognitionRate:90,description:"Dropbox folder preview",placeholders:["folderid","foldername","filename"],headers:{"Content-Type":"text/html"},queryParams:{dl:"0",subfolder_nav_tracking:"1"}},{id:"onedrive_personal",serviceName:"OneDrive",template:"/personal/{username}_domain_com/Documents/{path}/{filename}?d={shareid}&csf=1&web=1&e={expires}",category:"cloud_storage",trustScore:94,recognitionRate:91,description:"OneDrive personal file sharing",placeholders:["username","path","filename","shareid","expires"],headers:{"Content-Type":"application/pdf"},queryParams:{csf:"1",web:"1"}},{id:"onedrive_business",serviceName:"OneDrive for Business",template:"/sites/{sitename}/Shared%20Documents/{folder}/{filename}?d={shareid}&csf=1&web=1&at=9",category:"cloud_storage",trustScore:96,recognitionRate:94,description:"OneDrive for Business sharing",placeholders:["sitename","folder","filename","shareid"],headers:{"Content-Type":"application/pdf"},queryParams:{csf:"1",web:"1",at:"9"}},{id:"wordpress_media",serviceName:"WordPress",template:"/wp-content/uploads/{year}/{month}/{filename}.{extension}?ver={version}&download=1",category:"cms",trustScore:88,recognitionRate:85,description:"WordPress media file",placeholders:["year","month","filename","extension","version"],headers:{"Content-Type":"application/pdf"},queryParams:{download:"1"}},{id:"wordpress_plugin",serviceName:"WordPress",template:"/wp-content/plugins/{pluginname}/assets/{filename}.{extension}?ver={version}&cache={cache}",category:"cms",trustScore:85,recognitionRate:82,description:"WordPress plugin asset",placeholders:["pluginname","filename","extension","version","cache"],headers:{"Content-Type":"application/javascript"},queryParams:{}},{id:"shopify_product",serviceName:"Shopify",template:"/products/{producthandle}?variant={variantid}&utm_source={source}&utm_medium={medium}",category:"ecommerce",trustScore:87,recognitionRate:84,description:"Shopify product page",placeholders:["producthandle","variantid","source","medium"],headers:{"Content-Type":"text/html"},queryParams:{}},{id:"shopify_checkout",serviceName:"Shopify",template:"/cart/{carttoken}?discount={discountcode}&ref={referrer}&step=contact_information",category:"ecommerce",trustScore:89,recognitionRate:86,description:"Shopify checkout process",placeholders:["carttoken","discountcode","referrer"],headers:{"Content-Type":"text/html"},queryParams:{step:"contact_information"}},{id:"squarespace_file",serviceName:"Squarespace",template:"/s/{fileid}/download?format=original&download=1&token={token}",category:"cms",trustScore:84,recognitionRate:81,description:"Squarespace file download",placeholders:["fileid","token"],headers:{"Content-Type":"application/pdf"},queryParams:{format:"original",download:"1"}},{id:"wix_media",serviceName:"Wix",template:"/media/{mediaid}/{filename}.{extension}?dn={displayname}&token={token}",category:"cms",trustScore:82,recognitionRate:79,description:"Wix media file",placeholders:["mediaid","filename","extension","displayname","token"],headers:{"Content-Type":"application/pdf"},queryParams:{}},{id:"github_release",serviceName:"GitHub",template:"/{username}/{repository}/releases/download/{tag}/{filename}.{extension}",category:"development",trustScore:90,recognitionRate:88,description:"GitHub release download",placeholders:["username","repository","tag","filename","extension"],headers:{"Content-Type":"application/zip"},queryParams:{}},{id:"github_raw",serviceName:"GitHub",template:"/{username}/{repository}/raw/{branch}/{path}/{filename}.{extension}",category:"development",trustScore:88,recognitionRate:85,description:"GitHub raw file access",placeholders:["username","repository","branch","path","filename","extension"],headers:{"Content-Type":"text/plain"},queryParams:{}},{id:"slack_file",serviceName:"Slack",template:"/files/{teamid}/{fileid}/{filename}?t={timestamp}&download=true&origin_team={teamid}",category:"productivity",trustScore:91,recognitionRate:87,description:"Slack file sharing",placeholders:["teamid","fileid","filename","timestamp"],headers:{"Content-Type":"application/pdf"},queryParams:{download:"true"}},{id:"discord_attachment",serviceName:"Discord",template:"/attachments/{channelid}/{messageid}/{filename}?ex={expires}&is={issued}&hm={hash}",category:"social",trustScore:86,recognitionRate:83,description:"Discord file attachment",placeholders:["channelid","messageid","filename","expires","issued","hash"],headers:{"Content-Type":"application/pdf"},queryParams:{}},{id:"notion_file",serviceName:"Notion",template:"/file/{fileid}/{filename}?id={pageid}&table=block&spaceId={spaceid}&userId={userid}",category:"productivity",trustScore:89,recognitionRate:86,description:"Notion file attachment",placeholders:["fileid","filename","pageid","spaceid","userid"],headers:{"Content-Type":"application/pdf"},queryParams:{table:"block"}}])}selectByService(e){return this.mimicryPatterns.find(t=>t.serviceName.toLowerCase().includes(e.toLowerCase()))}selectOptimalPattern(e={}){const{preferHighTrust:t=!0,avoidDetection:a=!0,targetAudience:n="mixed"}=e;let s=[...this.mimicryPatterns];n==="business"?s=s.filter(r=>["cloud_storage","productivity","development"].includes(r.category)):n==="personal"&&(s=s.filter(r=>["cloud_storage","social","cms","ecommerce"].includes(r.category)));const c=s.map(r=>{let o=0;return t&&(o+=r.trustScore*.4),o+=r.recognitionRate*.3,(n==="business"&&["cloud_storage","productivity"].includes(r.category)||n==="personal"&&["social","ecommerce"].includes(r.category))&&(o+=20),a&&r.recognitionRate>85&&(o+=10),{pattern:r,score:o}});c.sort((r,o)=>o.score-r.score);const d=c.slice(0,Math.min(3,c.length));return d[Math.floor(Math.random()*d.length)].pattern}generateServiceParameters(e){const t={};return e.placeholders.forEach(a=>{const n=this.generateServiceValue(a,e);t[a]=n!=null?String(n):this.generateGenericValue(a)}),t}generateServiceValue(e,t){const a=new Date;switch(e){case"fileid":return this.generateGoogleFileId();case"folderid":return this.generateGoogleFolderId();case"resourcekey":return this.generateResourceKey();case"confirm":return"t";case"shareid":return this.generateDropboxShareId();case"tokenhash":return this.generateTokenHash();case"username":return this.generateUsername();case"sitename":return this.generateSiteName();case"path":return this.generatePath();case"pluginname":return this.generatePluginName();case"version":return this.generateVersion();case"cache":return Date.now().toString();case"producthandle":return this.generateProductHandle();case"variantid":return this.generateVariantId();case"carttoken":return this.generateCartToken();case"discountcode":return this.generateDiscountCode();case"repository":return this.generateRepository();case"tag":return this.generateTag();case"branch":return this.generateBranch();case"teamid":return this.generateTeamId();case"timestamp":return Math.floor(Date.now()/1e3).toString();case"channelid":return this.generateDiscordId();case"messageid":return this.generateDiscordId();case"expires":return Math.floor((Date.now()+864e5)/1e3).toString();case"issued":return Math.floor(Date.now()/1e3).toString();case"hash":return this.generateHash();case"pageid":return this.generateNotionId();case"spaceid":return this.generateNotionId();case"userid":return this.generateNotionId();case"filename":return this.generateFilename();case"extension":return this.generateExtension();case"year":return a.getFullYear().toString();case"month":return(a.getMonth()+1).toString().padStart(2,"0");case"source":return this.generateSource();case"medium":return this.generateMedium();case"referrer":return this.generateReferrer();case"displayname":return this.generateDisplayName();case"token":return this.generateToken();case"encrypted":return"ENCRYPTED_DATA_PLACEHOLDER";default:return this.generateGenericValue(e)}}generateGoogleFileId(){return`1${this.generateRandomString(32,"ALPHANUMERIC")}`}generateGoogleFolderId(){return`1${this.generateRandomString(32,"ALPHANUMERIC")}`}generateResourceKey(){return`0-${this.generateRandomString(39,"ALPHANUMERIC")}`}generateDropboxShareId(){return this.generateRandomString(15,"ALPHANUMERIC")}generateTokenHash(){return this.generateRandomString(43,"ALPHANUMERIC")}generateUsername(){const e=["john.smith","jane.doe","mike.johnson","sarah.wilson","david.brown"];return e[Math.floor(Math.random()*e.length)]}generateSiteName(){const e=["corporate","finance","hr","marketing","sales","it"];return e[Math.floor(Math.random()*e.length)]}generatePath(){const e=["Documents","Reports","Presentations","Shared"];return e[Math.floor(Math.random()*e.length)]}generatePluginName(){const e=["contact-form-7","yoast-seo","elementor","woocommerce","jetpack"];return e[Math.floor(Math.random()*e.length)]}generateVersion(){return`${Math.floor(Math.random()*5)+1}.${Math.floor(Math.random()*10)}.${Math.floor(Math.random()*20)}`}generateProductHandle(){const e=["premium-package","special-offer","limited-edition","bestseller"];return e[Math.floor(Math.random()*e.length)]}generateVariantId(){return(Math.floor(Math.random()*9e5)+1e5).toString()}generateCartToken(){return this.generateRandomString(32,"ALPHANUMERIC")}generateDiscountCode(){const e=["SAVE20","WELCOME10","SPECIAL25","NEWUSER15"];return e[Math.floor(Math.random()*e.length)]}generateRepository(){const e=["awesome-project","web-app","mobile-app","data-analysis","machine-learning"];return e[Math.floor(Math.random()*e.length)]}generateTag(){return`v${this.generateVersion()}`}generateBranch(){const e=["main","master","develop","feature/new-feature","release/v1.0"];return e[Math.floor(Math.random()*e.length)]}generateTeamId(){return`T${this.generateRandomString(10,"ALPHANUMERIC").toUpperCase()}`}generateDiscordId(){return(Math.floor(Math.random()*9e18)+1e18).toString()}generateHash(){return this.generateRandomString(64,"ALPHANUMERIC")}generateNotionId(){return`${this.generateRandomString(8,"ALPHANUMERIC")}-${this.generateRandomString(4,"ALPHANUMERIC")}-${this.generateRandomString(4,"ALPHANUMERIC")}-${this.generateRandomString(4,"ALPHANUMERIC")}-${this.generateRandomString(12,"ALPHANUMERIC")}`}generateFilename(){const e=["document","report","presentation","spreadsheet","image","file"];return`${e[Math.floor(Math.random()*e.length)]}_${Date.now().toString().slice(-6)}`}generateExtension(){const e=["pdf","docx","xlsx","pptx","jpg","png","zip"];return e[Math.floor(Math.random()*e.length)]}generateSource(){const e=["email","social","direct","search","referral"];return e[Math.floor(Math.random()*e.length)]}generateMedium(){const e=["email","cpc","organic","social","referral"];return e[Math.floor(Math.random()*e.length)]}generateReferrer(){const e=["google","facebook","twitter","linkedin","direct"];return e[Math.floor(Math.random()*e.length)]}generateDisplayName(){return this.generateFilename()}generateToken(){return this.generateRandomString(32,"ALPHANUMERIC")}generateGenericValue(e){return`${e}_${this.generateRandomString(8,"ALPHANUMERIC")}`}generateRandomString(e,t="ALPHANUMERIC"){const c=t==="ALPHA"?"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ":t==="NUMERIC"?"0123456789":"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let d="";for(let l=0;l<e;l++)d+=c.charAt(Math.floor(Math.random()*c.length));return d}getAllPatterns(){return[...this.mimicryPatterns]}getPatternsByCategory(e){return this.mimicryPatterns.filter(t=>t.category===e)}getHighTrustPatterns(){return this.mimicryPatterns.filter(e=>e.trustScore>=90).sort((e,t)=>t.trustScore-e.trustScore)}getHighRecognitionPatterns(){return this.mimicryPatterns.filter(e=>e.recognitionRate>=85).sort((e,t)=>t.recognitionRate-e.recognitionRate)}}const f=new u;export{u as BehavioralMimicryService,f as behavioralMimicry};
